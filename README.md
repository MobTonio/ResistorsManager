# Инструкция по работе с приложением ResistorsManager

## Описание
Приложение ResistorsManager предназначено для управления данными о резисторах: загрузки из текстовых файлов, отображения в таблице и экспорта в базу данных.

## Требования
- .NET Framework
- SQL Server (localhost)
- Windows OS

## Запуск приложения
1. Запустите приложение `ResistorsManager.exe`
2. Откроется главное окно с таблицей и двумя кнопками управления

## Работа с приложением

### Загрузка данных из текстового файла
1. Нажмите кнопку "Загрузить данные из текстового файла"
2. В открывшемся диалоговом окне выберите текстовый файл (.txt) с данными о резисторах
3. Файл должен содержать данные в формате таблицы с 12 полями:
   - Маркировка
   - Тип
   - Мощность (Вт)
   - Сопротивление
   - Точность
   - Драгоценный металл
   - Элемент
   - Содержание (г/шт)
   - Технология
   - Год выпуска
   - Производитель
   - Статус

Разделитель между полями: `,`
Разделитель между строками: символ новой строки

### Просмотр данных
После загрузки данных:
- Данные автоматически отобразятся в таблице
- Таблица сортируется по статусу и маркировке
- Сопротивление и точность форматируются для удобного чтения
- Данные автоматически сохраняются в Excel-файл на рабочем столе 

### Экспорт в базу данных
1. Убедитесь, что данные были предварительно загружены из TXT-файла
2. Нажмите кнопку "Экспорт в базу данных"
3. Приложение автоматически:
   - Создаст таблицу Resistors (если не существует)
   - Очистит существующие данные
   - Загрузит все резисторы в базу данных

## Особенности форматов данных

### Сопротивление
Поддерживаются форматы:
- Омы: "100 Ом", "100ом"
- Килоомы: "1 кОм", "1ком", "1 к"
- Мегаомы: "1 МОм", "1мом", "1 М"
В базе данных хранятся как число в омах

### Точность
Формат: "±5%" или "5%"
В базе данных хранятся как число

## Структура базы данных
Таблица `Resistors` содержит поля:
- `Id` (автоинкремент)
- `Marking` (маркировка)
- `Type` (тип)
- `Power` (мощность)
- `Resistance` (сопротивление)
- `Accuracy` (точность)
- `PreciousMetal` (драгоценный металл)
- `Element` (элемент)
- `Content` (содержание)
- `Technology` (технология)
- `ProductionYear` (год выпуска)
- `Manufacturer` (производитель)
- `Status` (статус)

## Обработка ошибок
- При ошибках загрузки файла выводятся информационные сообщения
- При отсутствии данных для экспорта выводится предупреждение
- Ошибки базы данных отображаются с детальной информацией

## Примечания
- Данные кэшируются в памяти на 30 минут
- Excel-файл сохраняется на рабочем столе с именем "ResistorsData.xlsx"
- Подключение к БД использует локальный сервер с стандартными параметрами